import{c as ne,u as se,f as ue,aw as ie,j as le,r as w,a as c,k as re,ax as ce,m as de,ay as fe,n as ve,az as he,w as K,aK as ge,a2 as me,aL as ye,aM as M,a5 as Pe,aN as ke,d as _,x as xe,aA as Ce,o as Te,g as Se,aO as pe,aP as qe,aQ as be,a4 as Oe,V as Ee,aR as Be,aS as Fe,ab as we}from"./index.69292362.js";import{u as Ke,v as D,a as Me,b as _e,c as De,p as A,r as R,s as Ae,d as Re}from"./QItemLabel.ac395789.js";var Qe=ne({name:"QMenu",inheritAttrs:!1,props:{...Ke,...se,...ue,...ie,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:D},self:{type:String,validator:D},offset:{type:Array,validator:Me},scrollTarget:{default:void 0},touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...le,"click","escapeKey"],setup(e,{slots:a,emit:o,attrs:s}){let n=null,v,d,h;const x=Se(),{proxy:g}=x,{$q:u}=g,i=w(null),l=w(!1),H=c(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),Q=re(e,u),{registerTick:N,removeTick:W}=ce(),{registerTimeout:C}=de(),{transitionProps:j,transitionStyle:I}=fe(e),{localScrollTarget:T,changeScrollEvent:U,unconfigureScrollTarget:z}=_e(e,B),{anchorEl:r,canShow:V}=De({showing:l}),{hide:S}=ve({showing:l,canShow:V,handleShow:Y,handleHide:Z,hideOnRouteChange:H,processOnMount:!0}),{showPortal:p,hidePortal:q,renderPortal:$}=he(x,i,te,"menu"),m={anchorEl:r,innerRef:i,onClickOutside(t){if(e.persistent!==!0&&l.value===!0)return S(t),(t.type==="touchstart"||t.target.classList.contains("q-dialog__backdrop"))&&Oe(t),!0}},b=c(()=>A(e.anchor||(e.cover===!0?"center middle":"bottom start"),u.lang.rtl)),G=c(()=>e.cover===!0?b.value:A(e.self||"top start",u.lang.rtl)),J=c(()=>(e.square===!0?" q-menu--square":"")+(Q.value===!0?" q-menu--dark q-dark":"")),X=c(()=>e.autoClose===!0?{onClick:ee}:{}),O=c(()=>l.value===!0&&e.persistent!==!0);K(O,t=>{t===!0?(pe(P),Re(m)):(M(P),R(m))});function y(){qe(()=>{let t=i.value;t&&t.contains(document.activeElement)!==!0&&(t=t.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||t.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||t.querySelector("[autofocus], [data-autofocus]")||t,t.focus({preventScroll:!0}))})}function Y(t){if(n=e.noRefocus===!1?document.activeElement:null,ge(F),p(),B(),v=void 0,t!==void 0&&(e.touchPosition||e.contextMenu)){const k=me(t);if(k.left!==void 0){const{top:oe,left:ae}=r.value.getBoundingClientRect();v={left:k.left-ae,top:k.top-oe}}}d===void 0&&(d=K(()=>u.screen.width+"|"+u.screen.height+"|"+e.self+"|"+e.anchor+"|"+u.lang.rtl,f)),e.noFocus!==!0&&document.activeElement.blur(),N(()=>{f(),e.noFocus!==!0&&y()}),C(()=>{u.platform.is.ios===!0&&(h=e.autoClose,i.value.click()),f(),p(!0),o("show",t)},e.transitionDuration)}function Z(t){W(),q(),E(!0),n!==null&&(t===void 0||t.qClickOutside!==!0)&&(((t&&t.type.indexOf("key")===0?n.closest('[tabindex]:not([tabindex^="-"])'):void 0)||n).focus(),n=null),C(()=>{q(!0),o("hide",t)},e.transitionDuration)}function E(t){v=void 0,d!==void 0&&(d(),d=void 0),(t===!0||l.value===!0)&&(ye(F),z(),R(m),M(P)),t!==!0&&(n=null)}function B(){(r.value!==null||e.scrollTarget!==void 0)&&(T.value=Pe(r.value,e.scrollTarget),U(T.value,f))}function ee(t){h!==!0?(ke(g,t),o("click",t)):h=!1}function F(t){O.value===!0&&e.noFocus!==!0&&be(i.value,t.target)!==!0&&y()}function P(t){o("escapeKey"),S(t)}function f(){const t=i.value;t===null||r.value===null||Ae({el:t,offset:e.offset,anchorEl:r.value,anchorOrigin:b.value,selfOrigin:G.value,absoluteOffset:v,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function te(){return _(Ce,j.value,()=>l.value===!0?_("div",{role:"menu",...s,ref:i,tabindex:-1,class:["q-menu q-position-engine scroll"+J.value,s.class],style:[s.style,I.value],...X.value},xe(a.default)):null)}return Te(E),Object.assign(g,{focus:y,updatePosition:f}),$}});function L(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const a=parseInt(e,10);return isNaN(a)?0:a}var Ne=Ee({name:"close-popup",beforeMount(e,{value:a}){const o={depth:L(a),handler(s){o.depth!==0&&setTimeout(()=>{const n=Be(e);n!==void 0&&Fe(n,s,o.depth)})},handlerKey(s){we(s,13)===!0&&o.handler(s)}};e.__qclosepopup=o,e.addEventListener("click",o.handler),e.addEventListener("keyup",o.handlerKey)},updated(e,{value:a,oldValue:o}){a!==o&&(e.__qclosepopup.depth=L(a))},beforeUnmount(e){const a=e.__qclosepopup;e.removeEventListener("click",a.handler),e.removeEventListener("keyup",a.handlerKey),delete e.__qclosepopup}});export{Ne as C,Qe as Q};
